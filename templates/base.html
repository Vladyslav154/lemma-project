<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
    </head>
<body>
    <div class="main-content">
        {% block content %}{% endblock %}
    </div>

    <div id="pro-key-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <span class="close-modal">&times;</span>
            <h2>{{ t('activate_key') }}</h2>
            <p>{{ t('enter_pro_key_subtitle') }}</p>
            <input type="text" id="pro-key-input" placeholder="PRO-XXXX-XXXX-XXXX">
            <button id="activate-pro-key-button" class="button">{{ t('activate_button') }}</button>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // ... (логика триала)

            // --- Логика активации Pro-ключа ---
            const modal = document.getElementById('pro-key-modal');
            const activateButtons = document.querySelectorAll('.activate-key-link');
            const closeModalButton = document.querySelector('.close-modal');
            const activateProKeyButton = document.getElementById('activate-pro-key-button');
            const proKeyInput = document.getElementById('pro-key-input');

            activateButtons.forEach(button => {
                button.addEventListener('click', (e) => {
                    e.preventDefault();
                    modal.classList.remove('hidden');
                });
            });

            const closeModal = () => modal.classList.add('hidden');
            closeModalButton.addEventListener('click', closeModal);
            modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });

            activateProKeyButton.addEventListener('click', () => {
                const enteredKey = proKeyInput.value.trim();
                if (enteredKey && enteredKey.startsWith("PRO-")) {
                    localStorage.setItem('lepko_pro_key', enteredKey);
                    localStorage.removeItem('lepko_trial_key');
                    alert("Pro-ключ принят!");
                    location.reload();
                } else {
                    alert("Неверный формат ключа.");
                }
            });
            
            if (localStorage.getItem('lepko_pro_key')) {
                // ... (логика отображения Pro-статуса)
            }
        });
    </script>
</body>
</html>